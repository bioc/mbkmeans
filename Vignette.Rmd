---
title: "vignette"
author: "Yuwei Ni"
date: "10/15/2018"
output: html_document
---

# example dataset

```{r}
library(TENxPBMCData)
library(scater)
library(SingleCellExperiment)
library(mbkmeans)
library(DelayedMatrixStats)
tenx_pbmc4k <- TENxPBMCData(dataset = "pbmc4k")
tenx_pbmc4k

#normalization
sce <- normalize(tenx_pbmc4k)

vars <- rowVars(logcounts(sce))
names(vars) <- rownames(sce)
vars <- sort(vars, decreasing = TRUE)

sce1000 <- sce[names(vars)[1:1000], 1:100]
```

#data analysis
```{r}
system.time(res <- mbkmeans(sce1000, clusters =3, batch_size = 4340,
                            reduceMethod = "none",
                            whichAssay = "logcounts"))
```


